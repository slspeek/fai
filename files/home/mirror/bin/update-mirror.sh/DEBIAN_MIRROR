#!/bin/bash
#
LOCATION=/home/mirror/debian-mirrors
DIST=trixie
ARCHITECTURES=amd64
MIRROR_FROM={%MIRROR_FROM%}

COMMON_OPTS=$(cat <<-EOF
  --verbose 
  --progress 
  --exclude=-dbg_* 
  --nosource 
  --method=http 
  --i18n 
  --getcontents 
  --arch=$ARCHITECTURES 
  --check-gpg 
  --keyring /usr/share/keyrings/debian-archive-keyring.gpg
  --host=$MIRROR_FROM 
EOF
)

echo
echo "`basename $0`: Upgrading Debian security repository ..."
debmirror \
  --root=debian-security \
  --section=main,contrib,non-free,non-free-firmware \
  --dist=$DIST-security \
  $COMMON_OPTS \
  $LOCATION/debian-security/ 
echo "`basename $0`: Upgrading Debian security repository: Done."

echo
echo "`basename $0`: Upgrading Debian default repository ..."
debmirror \
  --root=debian \
  --section=main,contrib,non-free,non-free-firmware,main/debian-installer \
  --dist=$DIST,$DIST-updates \
  $COMMON_OPTS \
  $LOCATION/debian/ 
echo "`basename $0`: Upgrading Debian default repository: Done."
echo

